## สรุปการใช้งาน Docker แบบ basic#1

### microservices คืออะไรกันนะ?
microservices คือชื่อของ architecture รูปแบบนึงในการออกแบบซอฟต์แวร์ ถ้าดูจากชื่อมันก็คือการแบ่งแต่ละ service ออกจากกันเป็น serviceเล็กๆ(micro) ซึ่งแต่ละ service อาจจะอยู่ในรูปของ container ก็ได้ ถ้าจะให้เห็นภาพมากขึ้นลองดูจากภาพข้างล่างที่เปรียบเทียบ monolithic กับ microservices

![alt text](https://)

**monolithic** ถ้าดูจากในรูปคือแทบจะรวมทุกอย่างไว้ในก้อนเดียวเลย แล้วยังใช้ database เดียวกันอีก ข้อดีคือ architecture แบบนี้ จัดการง่าย เพราะมี database ตัวเดียว ติดตั้งง่าย แต่ข้อเสียคือเมื่อพัฒนาระบบไปเรื่อยๆ จนมีความซับซ้อนระดับนึง ทุกอย่างจะเริ่มยาก เพราะต้องคำนึงถึงฟังก์ชันอื่นๆที่ทำงานอยู่ด้วย การที่เราแก้ตรงนี้ อาจจะไปกระทบกับตรงนู้น เป็นต้น

**microservices** แทบจะตรงข้ามกับ monolithic โดยที่ architecture แบบนี้จะพยายามแยกทุกอย่างออกจากกัน แต่ละ microservices ก็มี database เป็นของตัวเองด้วย ช่วยแก้ปัญหาเมื่อพัฒนาระบบจนมีความซับซ้อน สามารถแยกทำทีละส่วนได้ แก้ข้อมูลได้โดยไม่จำเป็นต้องคำนึงถึงส่วนอื่น เพราะแต่ละ service มี database เป็นของตัวเอง เหมาะกับทีมใหญ่ๆที่มีการทำงานกันหลายคน ซึ่งแต่ละอาจจะเลือกเครื่องมือสำหรับพัฒนาตามทีถนัดได้เลย

### แล้ว Docker กับ container มันเกี่ยวอะไร?
การที่เราจะมี microservices ได้ ที่คนส่วนใหญ่นิยมทำกันคือ แบ่งแต่ละ service ออกเป็น container (เหมือนเป็นกล่อง) ซึ่งในแต่ละ container ก็จะมี environment เป็นของตัวเอง
แล้ว Docker นี่แหละ ที่เป็นพระเอกของเราในการสร้าง container ขึ้นมา จริงๆแล้วหลักการของ Docker จะคล้ายๆกับ VM แต่จะมีส่วนที่แตกต่างกันนิดหน่อย ดูในรูปด้านล่างก่อนเลย

![alt text](https://)

VM จะเห็นได้ว่าจะมีการสร้าง OS ขึ้นมา (เรียกว่า Guest OS) สำหรับแต่ละ VM เลย เสมือนเป็นเครื่องอีกเครื่องไปเลย ในแต่ละเครื่องก็อาจจะมี library หรือ environment ต่างกัน ซึ่งจะจัดการแต่ละ VM ด้วย Hypervisor
ซึ่ง microservices จริงๆมันต้องการแค่การที่มี environment ต่างกันก็พอ ไม่ได้ถึงขนาดต้องการเครื่องแยกๆกัน ก็เลยเป็นที่มาของการสร้าง container
Container ที่สร้างด้วย docker เนี่ย เห็นได้ว่ายังใช้ OS เดียวกันอยู่ (จริงๆน่าจะหมายถึง kernel เดียวกัน) เพียงแต่สิ่งที่ต่างกันคือมี environment เป็นของตัวเอง นั่นแหละ ข้อดีที่เห็นชัดเลยคือมันจะมีความ lightweight มากกว่า VM เพราะไม่ต้องสร้างตั้งแต่ OS

### เริ่มเรื่อง Docker กันเลยดีกว่า

**docker** เป็น engine ตัวนึงที่ใช้สำหรับการจำลอง environment โดยมันจะอยู่ในลักษณะของ container แต่ละ container ที่ถูกสร้างขึ้นก็จะมี environment ที่เราต้องการอยู่ในนั้น หลายๆคนน่าจะเคยได้ยินคำว่า docker image, docker container เดี๋ยวผมจะสรุปคร่าวๆว่ามันคืออะไร

**docker image** อาจจะมองว่าเป็นไฟล์แผ่น CD ที่ใช้ลง OS หรืออาจจะเป็นสูตรอาหารก็ได้ครับ มันคือต้นแบบของ container ที่เราจะสร้าง ที่จะบอกว่าถ้าเราสร้าง container จาก image นี้ container จะมีหน้าตาเป็นยังไง มี environment แบบไหน

**docker container** ถ้าเรามองว่า image เป็นไฟล์แผ่น CD ที่ใช้ลง OS งั้น container ก็น่าจะเป็น OS ที่เราลงด้วยแผ่น CD นั้นนั่นแหละ หรือถ้ามอง image เป็นสูตรอาหาร container ก็น่าจะเป็นอาหารที่เราทำตามสูตรนั้น โดยที่เมื่อเราลง OS หรือทำอาหารเสร็จแล้ว เราอาจจะปรับเปลี่ยนอะไรใน OS นั้นก็ได้ หรืออาจจะใส่น้ำตาล น้ำปลาลงในอาหาร แต่เมื่อเราจะลง OS ใหม่ หรือทำอาหารใหม่ มันก็จะเป็นไปตามสูตรเหมือนเดิม นั่นแหละครับ container
สรุปขั้นตอนให้อยู่ในรูปเดียวข้างล่าง

![alt text](https://)

โดยที่ Dockerfile เป็นเหมือน script ที่เอาไว้สร้าง image อีกทีครับ แล้วค่อยเอา image ไปสร้าง container
